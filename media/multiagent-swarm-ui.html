<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MultiAgenticSwarm - VSCode Extension</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1e1e1e;
            --bg-secondary: #252526;
            --bg-tertiary: #2d2d30;
            --bg-hover: #3e3e42;
            --text-primary: #cccccc;
            --text-secondary: #9d9d9d;
            --accent-blue: #007acc;
            --accent-green: #4ec9b0;
            --accent-purple: #c586c0;
            --accent-orange: #ce9178;
            --accent-red: #f48771;
            --border-color: #464647;
            --shadow: rgba(0, 0, 0, 0.3);
            --modal-overlay: rgba(0, 0, 0, 0.5);
            --focus-glow: rgba(0, 122, 204, 0.1);
            --button-shadow: rgba(0, 122, 204, 0.3);
            --agent-blue-tint: rgba(0, 122, 204, 0.05);
            --agent-green-tint: rgba(78, 201, 176, 0.05);
            --agent-purple-tint: rgba(197, 134, 192, 0.05);
            --scrollbar-thumb: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            --scrollbar-thumb-hover: linear-gradient(135deg, #0088ff, #d688d6);
            --scrollbar-thumb-active: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            --activity-bar-bg: #333333;
            --activity-bar-inactive: #858585;
            --activity-bar-active: #ffffff;
        }

        [data-theme="light"] {
            --bg-primary: #ffffff;
            --bg-secondary: #f3f3f3;
            --bg-tertiary: #e8e8e8;
            --bg-hover: #e0e0e0;
            --text-primary: #1e1e1e;
            --text-secondary: #616161;
            --accent-blue: #0066cc;
            --accent-green: #00a86b;
            --accent-purple: #af4c9a;
            --accent-orange: #d2691e;
            --accent-red: #e74c3c;
            --border-color: #d0d0d0;
            --shadow: rgba(0, 0, 0, 0.1);
            --modal-overlay: rgba(0, 0, 0, 0.3);
            --focus-glow: rgba(0, 102, 204, 0.15);
            --button-shadow: rgba(0, 102, 204, 0.25);
            --agent-blue-tint: rgba(0, 102, 204, 0.08);
            --agent-green-tint: rgba(0, 168, 107, 0.08);
            --agent-purple-tint: rgba(175, 76, 154, 0.08);
            --scrollbar-thumb: linear-gradient(135deg, #e0e0e0, #f0f0f0);
            --scrollbar-thumb-hover: linear-gradient(135deg, #d0d0d0, #e8e8e8);
            --scrollbar-thumb-active: linear-gradient(135deg, #c8c8c8, #e0e0e0);
            --activity-bar-bg: #f0f0f0;
            --activity-bar-inactive: #666666;
            --activity-bar-active: #1e1e1e;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        .vscode-container {
            display: flex;
            height: 100vh;
            flex-direction: column;
        }

        .main-layout {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Status Bar */
        .status-bar {
            height: 22px;
            background-color: var(--accent-blue);
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-size: 12px;
            color: white;
            justify-content: space-between;
        }

        .status-left {
            display: flex;
            gap: 20px;
        }

        .status-right {
            display: flex;
            gap: 20px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Activity Bar */
        .activity-bar {
            width: 48px;
            background-color: var(--activity-bar-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 0;
        }

        .activity-icon {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            color: var(--activity-bar-inactive);
            transition: color 0.2s;
        }

        .activity-icon:hover {
            color: var(--activity-bar-active);
        }

        .activity-icon.active {
            color: var(--activity-bar-active);
        }

        .activity-icon.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            bottom: 8px;
            width: 2px;
            background-color: var(--activity-bar-active);
        }

        .activity-icon svg {
            width: 24px;
            height: 24px;
        }

        /* Editor Space (Mock) */
        .editor-space {
            flex: 1;
            background-color: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid var(--border-color);
            min-width: 0; /* Allow shrinking */
        }

        .editor-placeholder {
            text-align: center;
            color: var(--text-secondary);
        }

        .editor-placeholder h3 {
            font-size: 24px;
            font-weight: 300;
            margin-bottom: 16px;
        }

        .editor-placeholder p {
            font-size: 14px;
            opacity: 0.7;
        }

        /* Extension Panel */
        .extension-panel {
            width: 800px;
            display: flex;
            background-color: var(--bg-primary);
            transition: width 0.3s ease;
        }

        .extension-panel.hidden {
            width: 0;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex: 1;
            position: relative;
        }

        /* Resizable Splitter */
        .resizer {
            width: 4px;
            background: var(--border-color);
            cursor: col-resize;
            position: relative;
            transition: background-color 0.2s ease;
            flex-shrink: 0;
        }

        .resizer:hover {
            background: var(--accent-blue);
        }

        .resizer:active {
            background: var(--accent-blue);
        }

        .resizer::before {
            content: '';
            position: absolute;
            top: 0;
            left: -2px;
            right: -2px;
            bottom: 0;
            cursor: col-resize;
        }

        .sidebar {
            width: 320px;
            min-width: 250px;
            max-width: 600px;
            background-color: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            flex-shrink: 0;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 400px;
        }

        /* Sidebar */
        .sidebar {
            width: 320px;
            background-color: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: width 0.3s ease;
        }

        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--bg-tertiary);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
            font-weight: 600;
            color: var(--accent-blue);
        }

        .swarm-selector {
            margin-top: 12px;
            display: flex;
            gap: 8px;
        }

        .dropdown {
            flex: 1;
            position: relative;
        }

        .dropdown-button {
            width: 100%;
            padding: 8px 12px;
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .dropdown-button:hover {
            background-color: var(--bg-hover);
            border-color: var(--accent-blue);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin-top: 4px;
            display: none;
            z-index: 100;
            box-shadow: 0 4px 8px var(--shadow);
        }

        .dropdown-menu.active {
            display: block;
        }

        .dropdown-item {
            padding: 8px 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .dropdown-item:hover {
            background-color: var(--bg-hover);
        }

        .dropdown-item.add-new {
            color: var(--accent-green);
            border-top: 1px solid var(--border-color);
        }

        /* Agents List */
        .agents-section {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .section-title {
            font-size: 12px;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .add-button {
            width: 24px;
            height: 24px;
            background-color: var(--accent-green);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .add-button:hover {
            background-color: #3db394;
            transform: scale(1.1);
        }

        .agent-card {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .agent-card:hover {
            border-color: var(--accent-blue);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .agent-card.active {
            border-color: var(--accent-blue);
            background-color: var(--bg-tertiary);
        }

        .agent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .agent-name {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .agent-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .agent-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--accent-green);
        }

        .agent-tools {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .main-header {
            padding: 16px 24px;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .main-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .panel-collapse-btn {
            width: 32px;
            height: 32px;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .panel-collapse-btn:hover {
            background-color: var(--bg-hover);
            border-color: var(--border-hover);
        }

        .collapse-icon {
            font-size: 14px;
            transition: transform 0.3s ease;
        }

        /* Main content collapsed state */
        .main-content.collapsed {
            width: 50px;
            min-width: 50px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .main-content.collapsed .main-header {
            padding: 8px;
            justify-content: flex-start;
        }

        .main-content.collapsed .main-header-left h2,
        .main-content.collapsed .header-actions,
        .main-content.collapsed .agent-config {
            display: none;
        }

        .main-content.collapsed .main-header-left {
            gap: 0;
        }

        /* Panel collapse button in collapsed state */
        .main-content.collapsed .panel-collapse-btn {
            margin: 0;
        }

        .main-content.collapsed .panel-collapse-btn .collapse-icon {
            transform: rotate(0deg);
        }

        /* Sidebar expanded state when main panel is collapsed */
        .sidebar.expanded {
            width: calc(100% - 50px);
            transition: width 0.3s ease;
        }

        /* Resizer hidden when main panel is collapsed */
        .resizer.hidden {
            display: none;
        }



        /* Make container position relative for absolute positioning */
        .container {
            position: relative;
        }

        /* Agent Configuration */
        .agent-config {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }

        .config-section {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .config-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--accent-blue);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 8px 12px;
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            font-family: inherit;
            transition: all 0.2s;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Tools Section */
        .tools-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .tool-item {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .tool-item:hover {
            border-color: var(--accent-purple);
        }

        .tool-info {
            flex: 1;
        }

        .tool-name {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .tool-description {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-hover);
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--accent-green);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }

        /* Chat Interface */
        .chat-section {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            height: 450px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 12px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .chat-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), var(--accent-green));
            border-radius: 12px 12px 0 0;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 16px;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            scroll-behavior: smooth;
        }

        .message {
            margin-bottom: 20px;
            padding: 16px 20px;
            border-radius: 12px;
            background: var(--bg-secondary);
            border-left: 4px solid;
            position: relative;
            transform: translateY(0);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px var(--shadow);
            animation: messageSlideIn 0.3s ease-out;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px var(--shadow);
        }

        .message.agent-1 {
            border-left-color: var(--accent-blue);
            background: linear-gradient(135deg, var(--bg-secondary), var(--agent-blue-tint));
        }

        .message.agent-2 {
            border-left-color: var(--accent-green);
            background: linear-gradient(135deg, var(--bg-secondary), var(--agent-green-tint));
        }

        .message.agent-3 {
            border-left-color: var(--accent-purple);
            background: linear-gradient(135deg, var(--bg-secondary), var(--agent-purple-tint));
        }

        .message-header {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .message-header::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
        }

        .message.agent-1 .message-header {
            color: var(--accent-blue);
        }

        .message.agent-2 .message-header {
            color: var(--accent-green);
        }

        .message.agent-3 .message-header {
            color: var(--accent-purple);
        }

        .message-content {
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 14px;
        }

        .chat-input-container {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .chat-input {
            flex: 1;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px var(--focus-glow);
        }

        .send-button {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            min-width: 80px;
        }

        .send-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px var(--button-shadow);
        }

        .send-button:active {
            transform: translateY(0);
        }

        /* Collaboration Config */
        .collab-visual {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-top: 16px;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .agent-node {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            position: absolute;
            cursor: pointer;
            transition: all 0.2s;
        }

        .agent-node:hover {
            transform: scale(1.1);
        }

        .connection-line {
            position: absolute;
            height: 2px;
            background-color: var(--border-color);
            transform-origin: left center;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--modal-overlay);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .close-button {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
        }

        .close-button:hover {
            color: var(--text-primary);
        }

        /* Performance Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .metric-card {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 12px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 600;
            color: var(--accent-green);
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Enhanced Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb);
            border-radius: 6px;
            border: 2px solid var(--bg-primary);
            transition: all 0.3s ease;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--scrollbar-thumb-hover);
            transform: scale(1.1);
        }

        ::-webkit-scrollbar-thumb:active {
            background: var(--scrollbar-thumb-active);
        }

        ::-webkit-scrollbar-corner {
            background: var(--bg-primary);
        }

        /* Custom scrollbar for chat messages */
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb);
            border-radius: 4px;
            border: 1px solid var(--bg-secondary);
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: var(--scrollbar-thumb-hover);
        }


        /* chat panel */
        .panel {
            flex: 1;
            display: none;
            flex-direction: column;
            overflow: hidden;
            min-width: 0;
        }

        #chatPanel {
            display: flex; /* Show this panel by default */
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            box-sizing: border-box;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-primary);
            min-height: 0;
        }

        .chat-input-area {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input-area input {
            flex: 1;
            padding: 8px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .chat-input-area button {
            background: var(--accent-blue);
            border: none;
            padding: 8px 12px;
            color: white;
            cursor: pointer;
        }


        /* Enhanced Settings Modal Styles */
        .settings-modal {
            max-width: 600px;
            max-height: 85vh;
        }

        .modal-title-section {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .modal-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin: 0;
        }

        .settings-sections {
            display: flex;
            flex-direction: column;
            gap: 24px;
            margin-top: 24px;
        }

        .settings-section {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            white-space: nowrap;
        }

        .section-divider {
            flex: 1;
            height: 1px;
            background: linear-gradient(to right, var(--border-color), transparent);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .setting-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .setting-item:first-child {
            padding-top: 0;
        }

        .setting-info {
            flex: 1;
            margin-right: 16px;
        }

        .setting-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .setting-description {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .setting-control {
            display: flex;
            align-items: center;
        }

        /* Enhanced Theme Toggle */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .theme-toggle .toggle-slider {
            border-radius: 30px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
        }

        .theme-toggle .toggle-slider:before {
            width: 24px;
            height: 24px;
            left: 3px;
            bottom: 3px;
            background: linear-gradient(135deg, #fff, #f0f0f0);
            box-shadow: 0 2px 4px var(--shadow);
        }

        .theme-toggle input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        .theme-switch-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .theme-label {
            font-size: 12px;
            color: var(--text-secondary);
            user-select: none;
        }

        /* Enhanced Dropdown for Settings */
        .settings-dropdown {
            min-width: 200px;
        }

        .settings-dropdown-button {
            padding: 12px 16px;
            border-radius: 6px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }

        .settings-dropdown-button:hover {
            border-color: var(--accent-blue);
            box-shadow: 0 2px 8px var(--shadow);
        }

        .dropdown-content {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dropdown-icon {
            font-size: 14px;
        }

        .dropdown-arrow {
            font-size: 10px;
            transition: transform 0.2s ease;
        }

        .dropdown.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .settings-dropdown .dropdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            border-radius: 4px;
            margin: 2px;
        }

        .settings-dropdown .dropdown-item:hover {
            background-color: var(--accent-blue);
            color: white;
        }

        /* Action Buttons */
        .settings-actions {
            display: flex;
            gap: 12px;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }

        .settings-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .primary-btn {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            color: white;
        }

        .primary-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px var(--button-shadow);
        }

        .secondary-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .secondary-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-green);
        }

        .btn-icon {
            font-size: 16px;
        }

        /* Notification System */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 2000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, var(--accent-green), #2ecc71);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--accent-red), #e74c3c);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .settings-modal {
                margin: 20px;
                max-height: 90vh;
            }
            
            .setting-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
            
            .setting-control {
                align-self: flex-end;
            }
            
            .settings-actions {
                flex-direction: column;
            }
        }

        /* chat panel */

        /* Message animations and loading states */
        .message {
            animation: messageSlideIn 0.3s ease-out;
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 16px 20px;
            background: var(--bg-secondary);
            border-radius: 12px;
            border-left: 4px solid var(--accent-blue);
            margin-bottom: 20px;
            animation: messageSlideIn 0.3s ease-out;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--accent-blue);
            border-radius: 50%;
            animation: typingPulse 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingPulse {
            0%, 80%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            40% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Enhanced config section for chat */
        .config-section:has(.chat-section) {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 16px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .config-section:has(.chat-section)::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), var(--accent-green));
        }

        /* Collapsible Sections */
        .collapsible-section {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .collapsible-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            border-bottom: 1px solid transparent;
        }

        .collapsible-header:hover {
            background: linear-gradient(135deg, var(--bg-hover), var(--bg-tertiary));
        }

        .collapsible-header.active {
            border-bottom-color: var(--border-color);
        }

        .collapsible-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-blue);
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 0;
        }

        .collapsible-icon {
            font-size: 14px;
            color: var(--accent-blue);
        }

        .toggle-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .toggle-button:hover {
            background-color: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
            transform: scale(1.1);
        }

        .toggle-button.collapsed {
            transform: rotate(180deg);
        }

        .toggle-button.collapsed:hover {
            transform: rotate(180deg) scale(1.1);
        }

        .collapsible-content {
            padding: 20px;
            max-height: 1000px;
            opacity: 1;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .collapsible-content.collapsed {
            max-height: 0;
            padding: 0 20px;
            opacity: 0;
        }

        /* Enhanced config section styling for collapsible */
        .config-section {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .config-section.collapsible {
            padding: 0;
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .config-section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            border-bottom: 1px solid transparent;
        }

        .config-section-header:hover {
            background: linear-gradient(135deg, var(--bg-hover), var(--bg-tertiary));
        }

        .config-section-header.active {
            border-bottom-color: var(--border-color);
        }

        .config-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-blue);
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0;
        }

        .section-status-indicator {
            font-size: 12px;
            color: var(--text-secondary);
            background: var(--bg-primary);
            padding: 4px 8px;
            border-radius: 12px;
            margin-left: 8px;
        }

        .config-toggle-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .config-toggle-btn:hover {
            background-color: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
            transform: scale(1.1);
        }

        .config-toggle-btn.expanded::before {
            content: 'â–¼';
        }

        .config-toggle-btn.collapsed::before {
            content: 'â–¶';
        }

        .config-section-content {
            padding: 20px;
            max-height: 1000px;
            opacity: 1;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .config-section-content.collapsed {
            max-height: 0;
            padding: 0 20px;
            opacity: 0;
        }

        /* Special styling for chat section */
        .chat-collapsible .collapsible-content {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
        }

        .chat-collapsible .collapsible-header {
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
        }

        .chat-collapsible .collapsible-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), var(--accent-green));
        }

        .chat-collapsible {
            position: relative;
        }

        /* Responsive adjustments for collapsible sections */
        @media (max-width: 768px) {
            .collapsible-header {
                padding: 12px 16px;
            }
            
            .collapsible-title {
                font-size: 14px;
            }
            
            .collapsible-content {
                padding: 16px;
            }
        }

        /* Resizable Splitter */
        .resizer {
            width: 4px;
            background: var(--border-color);
            cursor: col-resize;
            position: relative;
            transition: background-color 0.2s ease;
            flex-shrink: 0;
        }

        .resizer:hover {
            background: var(--accent-blue);
        }

        .resizer:active {
            background: var(--accent-blue);
        }

        .resizer::before {
            content: '';
            position: absolute;
            top: 0;
            left: -2px;
            right: -2px;
            bottom: 0;
            cursor: col-resize;
        }

        /* Right Resizer for Main Panel */
        .main-panel-resizer {
            width: 4px;
            background: var(--border-color);
            cursor: col-resize;
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            transition: all 0.2s ease;
            flex-shrink: 0;
            z-index: 15;
            opacity: 0.6;
            display: block;
        }

        .main-panel-resizer:hover {
            background: var(--accent-blue);
            opacity: 1;
            width: 6px;
            right: -1px;
        }

        .main-panel-resizer:active {
            background: var(--accent-blue);
            opacity: 1;
            width: 6px;
            right: -1px;
        }

        .main-panel-resizer::before {
            content: '';
            position: absolute;
            top: 0;
            left: -4px;
            right: -4px;
            bottom: 0;
            cursor: col-resize;
        }

        .main-panel-resizer::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 2px;
            height: 20px;
            background: var(--text-secondary);
            border-radius: 1px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .main-panel-resizer:hover::after {
            opacity: 0.6;
        }

        /* Hide main panel resizer when collapsed */
        .main-content.collapsed + .main-panel-resizer {
            display: none;
        }

        /* Make container position relative for absolute positioning */
        .container {
            position: relative;
        }
    </style>
</head>
<body>
    <div class="vscode-container">
        <div class="main-layout">
        <!-- Activity Bar -->
         <!-- 
        <div class="activity-bar>
            <div class="activity-icon" title="Explorer">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17.5 0h-9L7 1.5V6H2.5L1 7.5v15.07L2.5 24h12.07L16 22.57V18h4.7l1.3-1.43v-15ZM14 2v5H9V2Zm-7 7h7v7H7Zm7 9v5H9v-5ZM3 9h4v7H3Zm13 7h4v-7h-4Z"/>
                </svg>
            </div>
            <div class="activity-icon" title="Search">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M15.25 0a8.25 8.25 0 0 0-6.18 13.72L1 22.88l1.12 1L10.29 16a8.25 8.25 0 1 0 4.96-16Zm0 15a6.75 6.75 0 1 1 0-13.5a6.75 6.75 0 0 1 0 13.5Z"/>
                </svg>
            </div>
            <div class="activity-icon" title="Source Control">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M21.007 8.222A3.738 3.738 0 0 0 15.045 5.2a3.737 3.737 0 0 0 1.156 6.583a2.988 2.988 0 0 1-2.668 1.67h-2.99a4.456 4.456 0 0 0-2.989 1.165V7.4a3.737 3.737 0 1 0-1.494 0v9.117a3.776 3.776 0 1 0 1.816.099a2.99 2.99 0 0 1 2.668-1.667h2.99a4.484 4.484 0 0 0 4.223-3.039a3.736 3.736 0 0 0 3.25-3.687zM4.565 3.738a2.242 2.242 0 1 1 4.484 0a2.242 2.242 0 0 1-4.484 0zm4.484 16.441a2.242 2.242 0 1 1-4.484 0a2.242 2.242 0 0 1 4.484 0zm8.221-9.715a2.242 2.242 0 1 1 0-4.485a2.242 2.242 0 0 1 0 4.485z"/>
                </svg>
            </div>
            <div class="activity-icon" title="Run and Debug">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10.94 13.5l-1.32 1.32a3.73 3.73 0 0 0-7.24 0L1.06 13.5L0 14.56l1.72 1.72l-.22.22V18H0v1.5h1.5v.08c.077.489.214.966.41 1.42L0 22.94L1.06 24l1.65-1.65A4.308 4.308 0 0 0 6 24a4.31 4.31 0 0 0 3.29-1.65L10.94 24L12 22.94L10.09 21c.198-.464.336-.951.41-1.45v-.1H12V18h-1.5v-1.5l-.22-.22L12 14.56l-1.06-1.06zM6 13.5a2.25 2.25 0 0 1 2.25 2.25h-4.5A2.25 2.25 0 0 1 6 13.5zm3 6a3.33 3.33 0 0 1-3 3a3.33 3.33 0 0 1-3-3v-2.25h6v2.25zm14.76-9.9v1.26L13.5 17.37V15.6l8.5-5.37L9 2v9.46a5.07 5.07 0 0 0-1.5-.72V.63L8.64 0l15.12 9.6z"/>
                </svg>
            </div>
            <div class="activity-icon active" title="MultiAgenticSwarm">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2a3 3 0 0 0-3 3c0 .6.18 1.16.5 1.63L7.91 8.22C7.42 7.89 6.84 7.71 6.21 7.71a3 3 0 0 0 0 6c.84 0 1.61-.35 2.16-.93l2.65 2.65c-.24.48-.37 1.01-.37 1.57a3 3 0 0 0 6 0c0-.84-.35-1.61-.93-2.16l2.65-2.65c.48.24 1.01.37 1.57.37a3 3 0 0 0 0-6c-.56 0-1.09.13-1.57.37l-2.65-2.65c.58-.55.93-1.32.93-2.16a3 3 0 0 0-3-3zm0 2a1 1 0 1 1 0 2a1 1 0 0 1 0-2zM6.21 9.71a1 1 0 1 1 0 2a1 1 0 0 1 0-2zm11.58 0a1 1 0 1 1 0 2a1 1 0 0 1 0-2zM12 15a1 1 0 1 1 0 2a1 1 0 0 1 0-2z"/>
                </svg>
            </div>
            <div class="activity-icon" title="Extensions">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M13.5 1.5L15 0H22.5L24 1.5V9L22.5 10.5H15L13.5 9V1.5ZM15 1.5V9H22.5V1.5H15ZM0 15V6L1.5 4.5H9L10.5 6V13.5H18L19.5 15V22.5L18 24H10.5L9 22.5V15H1.5L0 13.5ZM9 13.5V6H1.5V13.5H9ZM18 22.5V15H10.5V22.5H18Z"/>
                </svg>
            </div>
        </div>
        -->

        <!-- Editor Space (Mock) -->
         <!--
        <div class="editor-space">
            <div class="editor-placeholder">
                <h3>Welcome to VSCode</h3>
                <p>Open a folder to start coding</p>
                <p style="margin-top: 20px; font-size: 12px;">MultiAgenticSwarm panel is open â†’</p>
            </div>
        </div>
        -->

        <!-- Extension Panel -->
        <div class="extension-panel">
            <div class="container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span>ðŸ¤–</span>
                    <span>MultiAgenticSwarm</span>
                </div>
                <div class="swarm-selector">
                    <div class="dropdown">
                        <button class="dropdown-button" onclick="toggleDropdown('swarmDropdown')">
                            <span>FlutterSwarm</span>
                            <span>â–¼</span>
                        </button>
                        <div class="dropdown-menu" id="swarmDropdown">
                            <div class="dropdown-item" onclick="selectSwarm(this)">FlutterSwarm</div>
                            <div class="dropdown-item" onclick="selectSwarm(this)">PythonSwarm</div>
                            <div class="dropdown-item" onclick="selectSwarm(this)">ReactSwarm</div>
                            <div class="dropdown-item" onclick="selectSwarm(this)">DataScienceSwarm</div>
                            <div class="dropdown-item add-new" onclick="openModal('newSwarmModal')">+ Create New Swarm</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="agents-section">
                <div class="section-title">
                    <span>AGENTS</span>
                    <button class="add-button" onclick="openModal('newAgentModal')">+</button>
                </div>
                
                <div id="agentsList">
                    <div class="agent-card active" onclick="selectAgent(this, 'orchestrator')">
                        <div class="agent-header">
                            <div class="agent-name">
                                <div class="agent-color" style="background-color: var(--accent-blue);"></div>
                                <span>Orchestrator Agent</span>
                            </div>
                            <div class="agent-status"></div>
                        </div>
                        <div class="agent-tools">4 tools enabled</div>
                    </div>
                    
                    <div class="agent-card" onclick="selectAgent(this, 'cicd')">
                        <div class="agent-header">
                            <div class="agent-name">
                                <div class="agent-color" style="background-color: var(--accent-green);"></div>
                                <span>CI/CD Agent</span>
                            </div>
                            <div class="agent-status"></div>
                        </div>
                        <div class="agent-tools">3 tools enabled</div>
                    </div>
                    
                    <div class="agent-card" onclick="selectAgent(this, 'tests')">
                        <div class="agent-header">
                            <div class="agent-name">
                                <div class="agent-color" style="background-color: var(--accent-purple);"></div>
                                <span>Tests Agent</span>
                            </div>
                            <div class="agent-status"></div>
                        </div>
                        <div class="agent-tools">5 tools enabled</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resizable Splitter -->
        <div class="resizer" id="resizer"></div>
        
        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <div class="main-header">
                <div class="main-header-left">
                    <button class="panel-collapse-btn" id="panelCollapseBtn" onclick="toggleMainPanel()" onkeydown="if(event.key==='Enter'||event.key===' ') toggleMainPanel()" title="Collapse Panel">
                        <span class="collapse-icon">â—€</span>
                    </button>
                    <h2 id="currentAgentName">Orchestrator Agent Configuration</h2>
                </div>
                <div class="header-actions">
                    <button class="icon-button" title="Export Configuration" onclick="exportConfig()">ðŸ“¤</button>
                    <button class="icon-button" title="Import Configuration" onclick="importConfig()">ðŸ“¥</button>
                    <button class="icon-button" title="View Metrics" onclick="openModal('metricsModal')">ðŸ“Š</button>
                    <button class="icon-button" title="Settings" onclick="openModal('settingsModal')">âš™ï¸</button>
                </div>
            </div>
            
            <div class="agent-config">
                <!-- Basic Configuration -->
                <div class="config-section collapsible" id="basicConfigSection">
                    <div class="config-section-header" onclick="toggleConfigSection('basicConfigSection')">
                        <div style="display: flex; align-items: center;">
                            <h3 class="config-title" style="margin: 0;">Basic Configuration</h3>
                            <span class="section-status-indicator">4 fields</span>
                        </div>
                        <div class="config-toggle-btn expanded"></div>
                    </div>
                    
                    <div class="config-section-content">
                        <div class="form-group">
                        <label class="form-label">Agent Name</label>
                        <input type="text" class="form-input" id="agentName" value="Orchestrator Agent">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">System Prompt</label>
                        <textarea class="form-textarea" id="systemPrompt">You are an orchestrator agent responsible for coordinating tasks between different agents in the Flutter development workflow. Analyze incoming requests and delegate appropriately.</textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">LLM Configuration</label>
                        <div class="dropdown">
                            <button class="dropdown-button" onclick="toggleDropdown('llmDropdown')">
                                <span>OpenAI GPT-4</span>
                                <span>â–¼</span>
                            </button>
                            <div class="dropdown-menu" id="llmDropdown">
                                <div class="dropdown-item">OpenAI GPT-4</div>
                                <div class="dropdown-item">Claude 3</div>
                                <div class="dropdown-item">Local LLM (Ollama)</div>
                                <div class="dropdown-item">Custom API</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">API Key / Connection String</label>                            <input type="password" class="form-input" id="apiKey" placeholder="sk-...">
                        </div>
                    </div>
                </div>
                
                <!-- Tools Configuration -->
                <div class="config-section collapsible" id="toolsConfigSection">
                    <div class="config-section-header" onclick="toggleConfigSection('toolsConfigSection')">
                        <div style="display: flex; align-items: center;">
                            <h3 class="config-title" style="margin: 0;">Agent Tools</h3>
                            <span class="section-status-indicator">4 tools enabled</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button class="add-button" onclick="openModal('newToolModal')" title="Add New Tool">+</button>
                            <div class="config-toggle-btn expanded"></div>
                        </div>
                    </div>
                    
                    <div class="config-section-content">
                    
                    <div class="tools-list">
                        <div class="tool-item">
                            <div class="tool-info">
                                <div class="tool-name">Code Analysis</div>
                                <div class="tool-description">Analyzes Flutter code for best practices and patterns</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="tool-item">
                            <div class="tool-info">
                                <div class="tool-name">Task Delegation</div>
                                <div class="tool-description">Delegates tasks to appropriate specialized agents</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="tool-item">
                            <div class="tool-info">
                                <div class="tool-name">Progress Tracking</div>
                                <div class="tool-description">Monitors and reports on task completion status</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="tool-item">
                            <div class="tool-info">
                                <div class="tool-name">Dependency Resolution</div>
                                <div class="tool-description">Manages package dependencies and version conflicts</div>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    </div>
                </div>
                
                <!-- Collaboration Configuration -->
                <div class="config-section collapsible" id="collabConfigSection">
                    <div class="config-section-header" onclick="toggleConfigSection('collabConfigSection')">
                        <div style="display: flex; align-items: center;">
                            <h3 class="config-title" style="margin: 0;">Agent Collaboration</h3>
                            <span class="section-status-indicator">3 agents connected</span>
                        </div>
                        <div class="config-toggle-btn expanded"></div>
                    </div>
                    
                    <div class="config-section-content">
                        <div class="form-group">
                            <label class="form-label">Collaboration Rules</label>
                            <textarea class="form-textarea" id="collabRules">Orchestrator receives all initial requests â†’ CI/CD Agent handles deployment tasks â†’ Tests Agent validates all code changes â†’ All agents report back to Orchestrator</textarea>
                        </div>
                        
                        <div class="collab-visual" id="collabVisual">
                            <div class="agent-node" style="background-color: var(--accent-blue); left: 50%; top: 20%; transform: translateX(-50%);">O</div>
                            <div class="agent-node" style="background-color: var(--accent-green); left: 20%; bottom: 20%;">C</div>
                            <div class="agent-node" style="background-color: var(--accent-purple); right: 20%; bottom: 20%;">T</div>
                            <svg style="position: absolute; width: 100%; height: 100%; pointer-events: none;">
                                <line x1="50%" y1="35%" x2="30%" y2="65%" stroke="var(--border-color)" stroke-width="2"/>
                                <line x1="50%" y1="35%" x2="70%" y2="65%" stroke="var(--border-color)" stroke-width="2"/>
                                <line x1="30%" y1="70%" x2="70%" y2="70%" stroke="var(--border-color)" stroke-width="2" stroke-dasharray="5,5"/>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- Chat Interface -->
                <div class="config-section collapsible" id="chatConfigSection">
                    <div class="config-section-header" onclick="toggleConfigSection('chatConfigSection')">
                        <div style="display: flex; align-items: center;">
                            <h3 class="config-title" style="margin: 0;">Test Agent Responses</h3>
                            <div style="flex: 1; height: 1px; background: linear-gradient(to right, var(--border-color), transparent); margin: 0 12px;"></div>
                            <span class="section-status-indicator">Live Chat</span>
                        </div>
                        <div class="config-toggle-btn expanded"></div>
                    </div>
                    
                    <div class="config-section-content">
                    
                    <div class="chat-section">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message agent-1">
                                <div class="message-header">Orchestrator Agent</div>
                                <div class="message-content">I've received your request to implement a new authentication feature. Let me coordinate this with the team.</div>
                            </div>
                            
                            <div class="message agent-2">
                                <div class="message-header">CI/CD Agent</div>
                                <div class="message-content">I'll set up the deployment pipeline for the auth feature branch and configure the environment variables.</div>
                            </div>
                            
                            <div class="message agent-3">
                                <div class="message-header">Tests Agent</div>
                                <div class="message-content">I'm preparing unit tests for the authentication module and will run integration tests once the implementation is ready.</div>
                            </div>
                        </div>
                        
                        <div class="chat-input-container">
                            <input type="text" class="form-input chat-input" id="chatInput" placeholder="Ask your agents...">
                            <button class="send-button" onclick="sendMessage()">Send</button>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Right Resizer for Main Panel -->
        <div class="main-panel-resizer" id="mainPanelResizer" title="Drag to resize configuration panel"></div>
    </div>
    
    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-left">
            <div class="status-item">
                <span>ðŸŒ¿</span>
                <span>main</span>
            </div>
            <div class="status-item">
                <span>âš¡</span>
                <span>MultiAgenticSwarm v1.0.0</span>
            </div>
        </div>
        <div class="status-right">
            <div class="status-item">
                <span>ðŸ¤–</span>
                <span>3 Agents Active</span>
            </div>
            <div class="status-item">
                <span>Ln 1, Col 1</span>
            </div>
            <div class="status-item">
                <span>UTF-8</span>
            </div>
        </div>
    </div>
    </div>
    
    <!-- Modals -->
    <!-- New Agent Modal -->
    <div class="modal" id="newAgentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create New Agent</h3>
                <button class="close-button" onclick="closeModal('newAgentModal')">&times;</button>
            </div>
            
            <div class="form-group">
                <label class="form-label">Agent Name</label>
                <input type="text" class="form-input" placeholder="e.g., Database Agent">
            </div>
            
            <div class="form-group">
                <label class="form-label">Agent Color</label>
                <input type="color" class="form-input" value="#ff6b6b">
            </div>
            
            <div class="form-group">
                <label class="form-label">Initial System Prompt</label>
                <textarea class="form-textarea" placeholder="Describe the agent's role and capabilities..."></textarea>
            </div>
            
            <button class="send-button" style="width: 100%;" onclick="createNewAgent()">Create Agent</button>
        </div>
    </div>
    
    <!-- New Tool Modal -->
    <div class="modal" id="newToolModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Tool</h3>
                <button class="close-button" onclick="closeModal('newToolModal')">&times;</button>
            </div>
            
            <div class="form-group">
                <label class="form-label">Tool Name</label>
                <input type="text" class="form-input" placeholder="e.g., API Integration">
            </div>
            
            <div class="form-group">
                <label class="form-label">Implementation Type</label>
                <div class="dropdown">
                    <button class="dropdown-button" onclick="toggleDropdown('implDropdown')">
                        <span>AI-Generated Function</span>
                        <span>â–¼</span>
                    </button>
                    <div class="dropdown-menu" id="implDropdown">
                        <div class="dropdown-item" onclick="selectImplementation(this)">AI-Generated Function</div>
                        <div class="dropdown-item" onclick="selectImplementation(this)">Lambda Function</div>
                        <div class="dropdown-item" onclick="selectImplementation(this)">External API</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Tool Description / Lambda Function</label>
                <textarea class="form-textarea" placeholder="Describe what this tool should do or paste your lambda function..."></textarea>
            </div>
            
            <button class="send-button" style="width: 100%;" onclick="createNewTool()">Generate Tool</button>
        </div>
    </div>
    
    <!-- Metrics Modal -->
    <div class="modal" id="metricsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Agent Performance Metrics</h3>
                <button class="close-button" onclick="closeModal('metricsModal')">&times;</button>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">247</div>
                    <div class="metric-label">Tasks Completed</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">98%</div>
                    <div class="metric-label">Success Rate</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">1.2s</div>
                    <div class="metric-label">Avg Response Time</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">15</div>
                    <div class="metric-label">Active Tools</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$3.47</div>
                    <div class="metric-label">API Cost Today</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">4.8/5</div>
                    <div class="metric-label">User Rating</div>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <button class="send-button" style="width: 100%;" onclick="exportMetrics()">Export Detailed Report</button>
            </div>
        </div>
    </div>
    
    <!-- New Swarm Modal -->
    <div class="modal" id="newSwarmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create Custom Swarm</h3>
                <button class="close-button" onclick="closeModal('newSwarmModal')">&times;</button>
            </div>
            
            <div class="form-group">
                <label class="form-label">Swarm Name</label>
                <input type="text" class="form-input" placeholder="e.g., E-commerce Swarm">
            </div>
            
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-textarea" placeholder="Describe the purpose of this swarm..."></textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">Template</label>
                <div class="dropdown">
                    <button class="dropdown-button" onclick="toggleDropdown('templateDropdown')">
                        <span>Start from Scratch</span>
                        <span>â–¼</span>
                    </button>
                    <div class="dropdown-menu" id="templateDropdown">
                        <div class="dropdown-item" onclick="selectTemplate(this)">Start from Scratch</div>
                        <div class="dropdown-item" onclick="selectTemplate(this)">Clone FlutterSwarm</div>
                        <div class="dropdown-item" onclick="selectTemplate(this)">Clone PythonSwarm</div>
                        <div class="dropdown-item" onclick="selectTemplate(this)">Basic Web Development</div>
                    </div>
                </div>
            </div>
            
            <button class="send-button" style="width: 100%;" onclick="createNewSwarm()">Create Swarm</button>
        </div>


    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content settings-modal">
            <div class="modal-header">
                <div class="modal-title-section">
                    <h3 class="modal-title">Settings</h3>
                    <p class="modal-subtitle">Customize your MultiAgenticSwarm experience</p>
                </div>
                <button class="close-button" onclick="closeModal('settingsModal')">&times;</button>
            </div>
            
            <div class="settings-sections">
                <!-- Appearance Section -->
                               <div class="settings-section">
                    <div class="section-header">
                        <h4 class="section-title">Appearance</h4>
                        <div class="section-divider"></div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-label">Theme Mode</div>
                            <div class="setting-description">Switch between light and dark themes</div>
                        </div>
                        <div class="setting-control">
                            <div class="theme-switch-container">
                                <span class="theme-label">Dark</span>
                                <label class="toggle-switch theme-toggle">
                                    <input type="checkbox" id="themeToggle" onchange="toggleTheme()" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="theme-label">Light</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- General Section -->
                <div class="settings-section">
                    <div class="section-header">
                        <h4 class="section-title">General</h4>
                        <div class="section-divider"></div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-label">Auto-save Configuration</div>
                            <div class="setting-description">Automatically save changes to agent configurations</div>
                        </div>
                        <div class="setting-control">
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoSaveToggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-label">Notifications</div>
                            <div class="setting-description">Show system notifications and alerts</div>
                        </div>
                        <div class="setting-control">
                            <label class="toggle-switch">
                                <input type="checkbox" id="notificationsToggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- AI Configuration Section -->
                <div class="settings-section">
                    <div class="section-header">
                        <h4 class="section-title">AI Configuration</h4>
                        <div class="section-divider"></div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <div class="setting-label">Default LLM Provider</div>
                            <div class="setting-description">Choose your preferred language model provider</div>
                        </div>
                        <div class="setting-control">
                            <div class="dropdown settings-dropdown">
                                <button class="dropdown-button settings-dropdown-button" onclick="toggleDropdown('defaultLlmDropdown')">
                                    <div class="dropdown-content">
                                        <span>OpenAI GPT-4</span>
                                    </div>
                                    <span class="dropdown-arrow">â–¼</span>
                                </button>
                                <div class="dropdown-menu" id="defaultLlmDropdown">
                                                                       <div class="dropdown-item" onclick="selectDefaultLlm(this)">
                                        <span>OpenAI GPT-4</span>
                                    </div>
                                    <div class="dropdown-item" onclick="selectDefaultLlm(this)">
                                        <span>OpenAI GPT-3.5</span>
                                    </div>
                                    <div class="dropdown-item" onclick="selectDefaultLlm(this)">
                                        <span>Local LLM (Ollama)</span>
                                    </div>
                                    <div class="dropdown-item" onclick="selectDefaultLlm(this)">
                                        <span>Custom API</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="settings-actions">
                <button class="settings-btn secondary-btn" onclick="resetSettings()">
                    <span>Reset to Default</span>
                </button>
                <button class="settings-btn primary-btn" onclick="saveSettings()">
                    <span>Save Settings</span>
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Activity Bar functionality
        const activityIcons = document.querySelectorAll('.activity-icon');
        const extensionPanel = document.querySelector('.extension-panel');
        
        activityIcons.forEach((icon, index) => {
            icon.addEventListener('click', () => {
                // Remove active class from all icons
                activityIcons.forEach(i => i.classList.remove('active'));
                
                // Add active class to clicked icon
                icon.classList.add('active');
                
                // Toggle extension panel for MultiAgenticSwarm (index 4)
                if (index === 4) {
                    extensionPanel.classList.remove('hidden');
                } else {
                    extensionPanel.classList.add('hidden');
                }
            });
        });

        // Global state
        let activeAgent = 'orchestrator';
        let agents = {
            orchestrator: {
                name: 'Orchestrator Agent',
                color: 'var(--accent-blue)',
                tools: 4,
                systemPrompt: 'You are an orchestrator agent responsible for coordinating tasks...'
            },
            cicd: {
                name: 'CI/CD Agent',
                color: 'var(--accent-green)',
                tools: 3,
                systemPrompt: 'You handle continuous integration and deployment tasks...'
            },
            tests: {
                name: 'Tests Agent',
                color: 'var(--accent-purple)',
                tools: 5,
                systemPrompt: 'You are responsible for creating and running tests...'
            }
        };
        
        // Toggle dropdown
        function toggleDropdown(id) {
            const dropdown = document.getElementById(id);
            const allDropdowns = document.querySelectorAll('.dropdown-menu');
            
            allDropdowns.forEach(d => {
                if (d.id !== id) {
                    d.classList.remove('active');
                }
            });
            
            dropdown.classList.toggle('active');
        }
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown-menu').forEach(d => {
                    d.classList.remove('active');
                });
            }
        });
        
        // Select agent
        function selectAgent(element, agentId) {
            document.querySelectorAll('.agent-card').forEach(card => {
                card.classList.remove('active');
            });
            
            element.classList.add('active');
            activeAgent = agentId;
            
            // Update main content
            document.getElementById('currentAgentName').textContent = agents[agentId].name + ' Configuration';
            document.getElementById('agentName').value = agents[agentId].name;
            document.getElementById('systemPrompt').value = agents[agentId].systemPrompt;
        }
        
        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // Create new agent
        function createNewAgent() {
            const modal = document.getElementById("newAgentModal");

            const nameInput = modal.querySelector("input[type='text']");
            const colorInput = modal.querySelector("input[type='color']");
            const promptInput = modal.querySelector("textarea");

            const agentName = nameInput.value.trim() || "Untitled Agent";
            const agentColor = colorInput.value || "#ff6b6b";
            const agentPrompt = promptInput.value.trim() || "You are a new agent. Customize my behavior!";

            const agentId = `agent_${Date.now()}`;

            // Create visual agent card
            const newAgentCard = document.createElement('div');
            newAgentCard.className = 'agent-card';
            newAgentCard.setAttribute('onclick', `selectAgent(this, '${agentId}')`);
            newAgentCard.innerHTML = `
                <div class="agent-header">
                    <div class="agent-name">
                        <div class="agent-color" style="background-color: ${agentColor};"></div>
                        <span>${agentName}</span>
                    </div>
                    <div class="agent-status"></div>
                </div>
                <div class="agent-tools">0 tools enabled</div>
            `;

            // Append to sidebar
            document.getElementById('agentsList').appendChild(newAgentCard);

            // Add to global agent config
            agents[agentId] = {
                name: agentName,
                color: agentColor,
                tools: 0,
                systemPrompt: agentPrompt
            };

            // Reset modal fields
            nameInput.value = "";
            colorInput.value = "#ff6b6b";
            promptInput.value = "";

            // Close modal
            closeModal('newAgentModal');

            // Auto-select the new agent
            selectAgent(newAgentCard, agentId);
        }


        // Create new tool
        function createNewTool() {
            const modal = document.getElementById("newToolModal");

            const nameInput = modal.querySelector("input.form-input");
            const implDropdown = modal.querySelector(".dropdown-button span:first-child");
            const descInput = modal.querySelector("textarea.form-textarea");

            const toolName = nameInput.value.trim();
            const implType = implDropdown.textContent.trim();
            const toolDesc = descInput.value.trim();

            if (!toolName) {
                alert("Please enter a tool name.");
                return;
            }

            // Create tool card
            const newTool = document.createElement("div");
            newTool.className = "tool-item";
            newTool.innerHTML = `
                <div class="tool-info">
                    <div class="tool-name">${toolName}</div>
                    <div class="tool-description">${toolDesc || "No description provided."}</div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" checked>
                    <span class="toggle-slider"></span>
                </label>
            `;

            document.querySelector(".tools-list").appendChild(newTool);

            console.log("âœ… New Tool Created:", {
                name: toolName,
                type: implType,
                description: toolDesc
            });

            // Reset modal fields
            nameInput.value = "";
            descInput.value = "";
            implDropdown.textContent = "AI-Generated Function";

            // Close modal
            closeModal("newToolModal");
        }

        
        // Send message in chat
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                const chatMessages = document.getElementById('chatMessages');
                
                // Add user message
                const userMessage = document.createElement('div');
                userMessage.className = 'message';
                userMessage.style.borderLeftColor = 'var(--accent-orange)';
                userMessage.style.background = 'linear-gradient(135deg, var(--bg-secondary), rgba(206, 145, 120, 0.05))';
                userMessage.innerHTML = `
                    <div class="message-header">You</div>
                    <div class="message-content">${message}</div>
                `;
                
                chatMessages.appendChild(userMessage);
                input.value = '';
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Add typing indicator
                setTimeout(() => {
                    const typingIndicator = document.createElement('div');
                    typingIndicator.className = 'typing-indicator';
                    typingIndicator.id = 'typingIndicator';
                    typingIndicator.innerHTML = `
                        <div class="message-header">Orchestrator Agent</div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: var(--text-secondary); font-size: 12px;">typing</span>
                            <div class="typing-dots">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                            </div>
                        </div>
                    `;
                    
                    chatMessages.appendChild(typingIndicator);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // Replace typing indicator with actual response
                    setTimeout(() => {
                        typingIndicator.remove();
                        
                        const agentMessage = document.createElement('div');
                        agentMessage.className = 'message agent-1';
                        agentMessage.innerHTML = `
                            <div class="message-header">Orchestrator Agent</div>
                            <div class="message-content">Processing your request: "${message}". I'll coordinate with the appropriate agents to handle this task efficiently.</div>
                        `;
                        chatMessages.appendChild(agentMessage);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 1500);
                }, 500);
            }
        }
        
        // Export configuration
        function exportConfig() {
            const config = {
                swarm: 'FlutterSwarm',
                agents: agents,
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'swarm-config.json';
            a.click();
        }
        
        // Import configuration
        function importConfig() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const config = JSON.parse(event.target.result);
                        console.log('Imported config:', config);
                        alert('Configuration imported successfully!');
                    } catch (err) {
                        alert('Error importing configuration');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }
        
        // Create new swarm
        function createNewSwarm() {
            const nameInput = document.querySelector('#newSwarmModal input.form-input');
            const descInput = document.querySelector('#newSwarmModal textarea.form-textarea');
            const templateButton = document.querySelector('#templateDropdown').previousElementSibling;

            const swarmName = nameInput.value.trim();
            const description = descInput.value.trim();
            const template = templateButton.querySelector('span:first-child').textContent.trim();

            if (!swarmName) {
                alert("Please enter a name for the new swarm.");
                return;
            }

            // Create new swarm dropdown item
            const newItem = document.createElement("div");
            newItem.className = "dropdown-item";
            newItem.textContent = swarmName;
            newItem.setAttribute("onclick", "selectSwarm(this)");

            // Insert before the '+ Create New Swarm' item
            const dropdown = document.getElementById("swarmDropdown");
            const createNew = dropdown.querySelector(".add-new");
            dropdown.insertBefore(newItem, createNew);

            // Select the newly created swarm
            selectSwarm(newItem);

            // (Optional) Log or use the full config
            console.log("âœ… Created new swarm:", {
                name: swarmName,
                description,
                template
            });

            // Clear inputs
            nameInput.value = "";
            descInput.value = "";
            templateButton.querySelector('span:first-child').textContent = "Start from Scratch";

            // Close modal
            closeModal("newSwarmModal");
        }

        function selectTemplate(item) {
            const template = item.textContent.trim();
            const button = item.closest('.dropdown').querySelector('.dropdown-button span:first-child');
            button.textContent = template;
            item.closest('.dropdown-menu').classList.remove('active');
        }


        
        // Export metrics
        function exportMetrics() {
            alert('Detailed metrics report exported!');
        }

        // Select swarm from dropdown
        function selectSwarm(element) {
            const selected = element.textContent.trim();

            // Update visible label (first <span> inside button)
            const button = document.querySelector('.swarm-selector .dropdown-button span:first-child');
            button.textContent = selected;

            // Store selected value for later use
            const dropdownButton = document.querySelector('.swarm-selector .dropdown-button');
            dropdownButton.setAttribute('data-value', selected);

            // Close dropdown
            document.getElementById('swarmDropdown').classList.remove('active');
        }

        
        // Enter key to send message
        document.getElementById('chatInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });


        // for new agent tool
        function selectImplementation(item) {
            const value = item.textContent.trim();
            const button = item.closest(".dropdown").querySelector(".dropdown-button span:first-child");
            button.textContent = value;

            item.closest(".dropdown-menu").classList.remove("active");
        }

        // for the settings
        function toggleThemeMode() {
            const root = document.documentElement;
            const isLight = root.getAttribute("data-theme") === "light";

            if (isLight) {
                root.removeAttribute("data-theme");
                localStorage.setItem("theme", "dark");
            } else {
                root.setAttribute("data-theme", "light");
                localStorage.setItem("theme", "light");
            }
        }

        function toggleTheme() {
            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;
            
            if (themeToggle.checked) {
                // Dark mode
                body.removeAttribute('data-theme');
                localStorage.setItem('theme', 'dark');
            } else {
                // Light mode
                body.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            }
        }
        
        // Load saved theme on page load
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;
            
            if (savedTheme === 'light') {
                body.setAttribute('data-theme', 'light');
                themeToggle.checked = false;
            } else {
                body.removeAttribute('data-theme');
                themeToggle.checked = true;
            }
        }
        
        // Settings functions
        function selectDefaultLlm(element) {
            const text = element.querySelector('span').textContent;
            const button = element.closest('.dropdown').querySelector('.dropdown-button .dropdown-content span');
            
            button.textContent = text;
            
            // Close dropdown
            document.querySelectorAll('.dropdown-menu').forEach(d => {
                d.classList.remove('active');
            });
        }
        
        function saveSettings() {
            // Save all settings to localStorage
            const themeToggle = document.getElementById('themeToggle');
            const autoSaveToggle = document.getElementById('autoSaveToggle');
            const notificationsToggle = document.getElementById('notificationsToggle');
            const defaultLlmButton = document.querySelector('#defaultLlmDropdown').previousElementSibling.querySelector('.dropdown-content span');
            
            const settings = {
                theme: themeToggle.checked ? 'dark' : 'light',
                autoSave: autoSaveToggle ? autoSaveToggle.checked : true,
                notifications: notificationsToggle ? notificationsToggle.checked : true,
                defaultLlm: defaultLlmButton ? defaultLlmButton.textContent : 'OpenAI GPT-4'
            };
            
            localStorage.setItem('appSettings', JSON.stringify(settings));
            
            // Show success notification with better styling
            showNotification('Settings saved successfully!', 'success');
            closeModal('settingsModal');
        }
        
        function resetSettings() {
            // Reset to default values
            const themeToggle = document.getElementById('themeToggle');
            const autoSaveToggle = document.getElementById('autoSaveToggle');
            const notificationsToggle = document.getElementById('notificationsToggle');
            const defaultLlmButton = document.querySelector('#defaultLlmDropdown').previousElementSibling.querySelector('.dropdown-content span');
            
            if (themeToggle) themeToggle.checked = true;
            if (autoSaveToggle) autoSaveToggle.checked = true;
            if (notificationsToggle) notificationsToggle.checked = true;
            if (defaultLlmButton) defaultLlmButton.textContent = 'OpenAI GPT-4';
            
            // Apply dark theme
            document.body.removeAttribute('data-theme');
            localStorage.setItem('theme', 'dark');
            
            // Clear saved settings
            localStorage.removeItem('appSettings');
            
            showNotification('Settings reset to default!', 'success');
        }
        
        // Load settings on page load
        function loadSettings() {
            const savedSettings = localStorage.getItem('appSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                const themeToggle = document.getElementById('themeToggle');
                const autoSaveToggle = document.getElementById('autoSaveToggle');
                const notificationsToggle = document.getElementById('notificationsToggle');
                const defaultLlmButton = document.querySelector('#defaultLlmDropdown').previousElementSibling.querySelector('.dropdown-content span');
                
                if (themeToggle) {
                    themeToggle.checked = settings.theme === 'dark';
                }
                if (autoSaveToggle) {
                    autoSaveToggle.checked = settings.autoSave !== false;
                }
                if (notificationsToggle) {
                    notificationsToggle.checked = settings.notifications !== false;
                }
                if (settings.defaultLlm && defaultLlmButton) {
                    defaultLlmButton.textContent = settings.defaultLlm;
                }
            }
        }
        
        // Notification system
        function showNotification(message, type = 'success') {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(n => n.remove());
            
            // Create new notification
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Hide notification after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Toggle collapsible config sections
        function toggleConfigSection(sectionId) {
            const section = document.getElementById(sectionId);
            const header = section.querySelector('.config-section-header');
            const content = section.querySelector('.config-section-content');
            const toggleBtn = section.querySelector('.config-toggle-btn');
            
            // Toggle the collapsed state
            const isCollapsed = content.classList.contains('collapsed');
            
            if (isCollapsed) {
                // Expand
                content.classList.remove('collapsed');
                toggleBtn.classList.remove('collapsed');
                toggleBtn.classList.add('expanded');
                header.classList.add('active');
            } else {
                // Collapse
                content.classList.add('collapsed');
                toggleBtn.classList.remove('expanded');
                toggleBtn.classList.add('collapsed');
                header.classList.remove('active');
            }
        }

        // Main Panel Collapse/Expand Functionality
        let isMainPanelCollapsed = false;

        function toggleMainPanel() {
            const mainContent = document.getElementById('mainContent');
            const sidebar = document.getElementById('sidebar');
            const resizer = document.getElementById('resizer');
            const collapseBtn = document.getElementById('panelCollapseBtn');
            const collapseIcon = collapseBtn.querySelector('.collapse-icon');
            
            isMainPanelCollapsed = !isMainPanelCollapsed;
            
            if (isMainPanelCollapsed) {
                // Store current width before collapsing
                const currentWidth = mainContent.offsetWidth;
                if (currentWidth > 50) {
                    localStorage.setItem('mainPanelWidth', currentWidth.toString());
                }
                
                // Collapse the main panel
                mainContent.classList.add('collapsed');
                sidebar.classList.add('expanded');
                resizer.classList.add('hidden');
                collapseIcon.textContent = 'â–¶';
                collapseBtn.title = 'Expand Panel';
                
                // Reset any custom widths
                mainContent.style.width = '';
                mainContent.style.minWidth = '';
                sidebar.style.width = '';
                
                // Store the collapsed state
                localStorage.setItem('mainPanelCollapsed', 'true');
            } else {
                // Expand the main panel
                mainContent.classList.remove('collapsed');
                sidebar.classList.remove('expanded');
                resizer.classList.remove('hidden');
                collapseIcon.textContent = 'â—€';
                collapseBtn.title = 'Collapse Panel';
                
                // Restore saved width if available
                const savedWidth = localStorage.getItem('mainPanelWidth');
                if (savedWidth && parseInt(savedWidth) > 300) {
                    const width = parseInt(savedWidth);
                    mainContent.style.width = width + 'px';
                    mainContent.style.minWidth = width + 'px';
                    
                    // Adjust sidebar accordingly
                    const container = document.querySelector('.container');
                    const containerWidth = container.offsetWidth;
                    const newSidebarWidth = containerWidth - width - 8; // -8 for resizers
                    sidebar.style.width = Math.max(250, newSidebarWidth) + 'px';
                }
                
                // Store the expanded state
                localStorage.setItem('mainPanelCollapsed', 'false');
            }
        }

        function restoreMainPanelState() {
            const collapsed = localStorage.getItem('mainPanelCollapsed') === 'true';
            const savedWidth = localStorage.getItem('mainPanelWidth');
            
            if (collapsed) {
                isMainPanelCollapsed = false; // Set to false so toggle makes it true
                toggleMainPanel();
            } else if (savedWidth) {
                // Restore the saved width when panel is not collapsed
                const width = parseInt(savedWidth);
                if (width && width > 0) {
                    const mainContent = document.getElementById('mainContent');
                    const sidebar = document.getElementById('sidebar');
                    const container = document.querySelector('.container');
                    
                    if (mainContent && sidebar && container) {
                        // Set main panel width
                        mainContent.style.width = width + 'px';
                        mainContent.style.minWidth = width + 'px';
                        
                        // Adjust sidebar to fill remaining space
                        const containerWidth = container.offsetWidth;
                        const resizerWidth = 8; // Both resizers
                        const newSidebarWidth = containerWidth - width - resizerWidth;
                        sidebar.style.width = Math.max(250, newSidebarWidth) + 'px';
                    }
                }
            }
        }

        // Main Panel Resizer Functionality
        let isMainPanelResizing = false;

        function initializeMainPanelResizer() {
            const mainPanelResizer = document.getElementById('mainPanelResizer');
            const mainContent = document.getElementById('mainContent');
            const sidebar = document.getElementById('sidebar');
            const container = document.querySelector('.container');
            
            if (!mainPanelResizer || !mainContent || !sidebar || !container) {
                console.error('Missing required elements for main panel resizer');
                return;
            }

            // Make sure the resizer is visible
            mainPanelResizer.style.display = 'block';

            mainPanelResizer.addEventListener('mousedown', (e) => {
                // Only allow resizing when panel is NOT collapsed
                if (isMainPanelCollapsed) {
                    return;
                }
                
                isMainPanelResizing = true;
                document.body.style.cursor = 'col-resize';
                document.body.style.userSelect = 'none';
                
                // Add overlay to prevent iframe issues
                const overlay = document.createElement('div');
                overlay.id = 'main-resize-overlay';
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    cursor: col-resize;
                    z-index: 9999;
                `;
                document.body.appendChild(overlay);
                
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isMainPanelResizing) return;
                
                const containerRect = container.getBoundingClientRect();
                const sidebarWidth = sidebar.offsetWidth;
                const resizerWidth = 4; // Left resizer width
                const newMainWidth = containerRect.right - e.clientX;
                
                // Set min and max widths for main panel
                const minMainWidth = 300;
                const maxMainWidth = containerRect.width - sidebarWidth - resizerWidth - 50; // Leave some space for sidebar
                
                if (newMainWidth >= minMainWidth && newMainWidth <= maxMainWidth) {
                    // Set main panel width
                    mainContent.style.width = newMainWidth + 'px';
                    mainContent.style.minWidth = newMainWidth + 'px';
                    
                    // Adjust sidebar to fill remaining space
                    const remainingWidth = containerRect.width - newMainWidth - resizerWidth - 4; // -4 for main panel resizer
                    const newSidebarWidth = Math.max(250, remainingWidth);
                    sidebar.style.width = newSidebarWidth + 'px';
                }
                
                e.preventDefault();
            });

            document.addEventListener('mouseup', () => {
                if (isMainPanelResizing) {
                    stopMainPanelResizing();
                    
                    // Save the current width
                    const currentWidth = mainContent.offsetWidth;
                    localStorage.setItem('mainPanelWidth', currentWidth.toString());
                }
            });
        }

        function stopMainPanelResizing() {
            isMainPanelResizing = false;
            document.body.style.cursor = '';
            document.body.style.userSelect = '';
            
            // Remove overlay
            const overlay = document.getElementById('main-resize-overlay');
            if (overlay) {
                overlay.remove();
            }
        }

        function expandMainPanelWithWidth(width) {
            const mainContent = document.getElementById('mainContent');
            const sidebar = document.getElementById('sidebar');
            const resizer = document.getElementById('resizer');
            const collapseBtn = document.getElementById('panelCollapseBtn');
            const collapseIcon = collapseBtn.querySelector('.collapse-icon');
            
            // Expand the main panel
            mainContent.classList.remove('collapsed');
            sidebar.classList.remove('expanded');
            resizer.classList.remove('hidden');
            collapseIcon.textContent = 'â—€';
            collapseBtn.title = 'Collapse Panel';
            
            // Set the custom width
            mainContent.style.width = width + 'px';
            mainContent.style.minWidth = width + 'px';
            
            // Update sidebar width to fill remaining space
            const container = document.querySelector('.container');
            const containerWidth = container.offsetWidth;
            const newSidebarWidth = containerWidth - width - 8; // -8 for resizers
            sidebar.style.width = Math.max(250, newSidebarWidth) + 'px';
            
            // Update state
            isMainPanelCollapsed = false;
            localStorage.setItem('mainPanelCollapsed', 'false');
            localStorage.setItem('mainPanelWidth', width.toString());
        }

        // Resizable Splitter Functionality
        let isResizing = false;

        function initializeResizer() {
            const resizer = document.getElementById('resizer');
            const sidebar = document.getElementById('sidebar');
            const container = document.querySelector('.container');
            
            if (!resizer || !sidebar || !container) return;

            resizer.addEventListener('mousedown', (e) => {
                isResizing = true;
                document.body.style.cursor = 'col-resize';
                document.body.style.userSelect = 'none';
                
                // Add overlay to prevent iframe issues
                const overlay = document.createElement('div');
                overlay.id = 'resize-overlay';
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    cursor: col-resize;
                    z-index: 9999;
                `;
                document.body.appendChild(overlay);
                
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isResizing) return;
                
                const containerRect = container.getBoundingClientRect();
                const newWidth = e.clientX - containerRect.left;
                
                // Set min and max widths
                const minWidth = 250;
                const maxWidth = Math.min(600, containerRect.width * 0.7);
                
                if (newWidth >= minWidth && newWidth <= maxWidth) {
                    sidebar.style.width = newWidth + 'px';
                }
                
                e.preventDefault();
            });

            document.addEventListener('mouseup', () => {
                if (isResizing) {
                    isResizing = false;
                    document.body.style.cursor = '';
                    document.body.style.userSelect = '';
                    
                    // Remove overlay
                    const overlay = document.getElementById('resize-overlay');
                    if (overlay) {
                        overlay.remove();
                    }
                    
                    // Save the sidebar width to localStorage
                    const sidebarWidth = sidebar.style.width;
                    localStorage.setItem('sidebarWidth', sidebarWidth);
                }
            });
        }

        // Load saved sidebar width
        function loadSidebarWidth() {
            const savedWidth = localStorage.getItem('sidebarWidth');
            const sidebar = document.getElementById('sidebar');
            
            if (savedWidth && sidebar) {
                sidebar.style.width = savedWidth;
            }
        }

        // Window resize handler to maintain layout consistency
        function handleWindowResize() {
            const mainContent = document.getElementById('mainContent');
            const sidebar = document.getElementById('sidebar');
            const container = document.querySelector('.container');
            
            if (!mainContent || !sidebar || !container || isMainPanelCollapsed) return;
            
            const containerWidth = container.offsetWidth;
            const currentMainWidth = mainContent.offsetWidth;
            const resizerWidth = 8; // Both resizers
            const minMainWidth = 300;
            const minSidebarWidth = 250;
            
            // Check if current layout still fits
            const requiredWidth = currentMainWidth + minSidebarWidth + resizerWidth;
            
            if (requiredWidth > containerWidth) {
                // Adjust main panel width to fit
                const maxMainWidth = containerWidth - minSidebarWidth - resizerWidth;
                const newMainWidth = Math.max(minMainWidth, maxMainWidth);
                
                mainContent.style.width = newMainWidth + 'px';
                mainContent.style.minWidth = newMainWidth + 'px';
                
                // Update sidebar width
                const newSidebarWidth = containerWidth - newMainWidth - resizerWidth;
                sidebar.style.width = Math.max(minSidebarWidth, newSidebarWidth) + 'px';
                
                // Save the new width
                localStorage.setItem('mainPanelWidth', newMainWidth.toString());
            } else {
                // Update sidebar width to fill remaining space
                const newSidebarWidth = containerWidth - currentMainWidth - resizerWidth;
                sidebar.style.width = Math.max(minSidebarWidth, newSidebarWidth) + 'px';
            }
        }

        // Debounced resize handler to avoid excessive calls
        let resizeTimeout;
        function debouncedWindowResize() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(handleWindowResize, 150);
        }

        // Listen to window resize events
        window.addEventListener('resize', debouncedWindowResize);

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            loadSettings();
            initializeResizer();
            initializeMainPanelResizer();
            loadSidebarWidth();
            restoreMainPanelState();
            
            // Add window resize listener
            window.addEventListener('resize', debouncedWindowResize);
            
            // Initialize collapsible sections (all expanded by default)
            const collapsibleSections = ['basicConfigSection', 'toolsConfigSection', 'collabConfigSection', 'chatConfigSection'];
            collapsibleSections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    const header = section.querySelector('.config-section-header');
                    const toggleBtn = section.querySelector('.config-toggle-btn');
                    
                    // Set initial state to expanded
                    if (header) header.classList.add('active');
                    if (toggleBtn) {
                        toggleBtn.classList.add('expanded');
                        toggleBtn.classList.remove('collapsed');
                    }
                }
            });
        });



    </script>
</body>
</html>